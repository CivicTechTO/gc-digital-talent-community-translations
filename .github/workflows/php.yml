name: Php Unit Tests

on: [push]

jobs:
  phpunit:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v1

      - name: Install composer dependencies
        working-directory: api
        run: |

          cp .env.example .env
          composer install --prefer-dist
          composer install
          php artisan migrate:fresh --seed
          php artisan lighthouse:print-schema --write

      - name: PHPUnit tests
        working-directory: api
        run: vendor/bin/phpunit
